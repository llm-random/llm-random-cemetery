parent: configs/experiments/relativity_paper/local_search_baseline.yaml
md5_parent_hash: 9fc58de9ec98826b3c9cf299f58b4e4e
time: "160:00:00"
interactive_debug_session: false
interactive_debug: false
n_gpus: 8

params:
  name: "large_extrapolation"
  tags: ["large_extrapolation", "relativity_paper", "baseline"]

  dmodel: 1536
  n_blocks: 24
  n_att_heads: 12

  batch_size: 384
  cutoff: 1024

  n_steps: 50_000
  final_lr_step: 50_000
  lr_warmup_steps: 500

  learning_rate: 0.0002

  save_weights_interval: 0
  mixed_precision: True
  mixed_precision_dtype: bfloat16
  flash_attention: true
  loss_checkpoint_chungs: 8

  fsdp_enabled: true
  fsdp_modules_to_wrap: "EmbeddingLayer,PredictionHead,TransformerBlock"
  activation_checkpointing_modules: "EmbeddingLayer,PredictionHead,TransformerBlock"
  fsdp_selective_precision_modules: "AttentionMechanism,MoeGating,RoPE"

