parent: configs/baselines/gpt/dense/common.yaml
md5_parent_hash: 1b1451abcd3779c5960c78b2f48aecbc
time: 0-16:00:00
# cuda_visible: "2"
interactive_debug: true

# LOCAL:
n_gpus: 1

params:
  # tokenizer: gpt

  # blanx args
  name: "moe_interp"
  mixed_precision: true
  mixed_precision_dtype: bfloat16
  flash_attention: false
#  logger_types: ["stdout"]
  # use_neptune: false
  # grad_clip: 1.0

  tags: ["moe_interp"]
  ff_mode: token_choice
  residual_mode: no_norm
  n_experts: 2
  expert_size: 512
  d_model: 128
  ^torch_seed: [420, 421]

  n_att_heads: 12

  n_steps: 1_500_000
  learning_rate: 1e-3
  decoding_interval: 0
  logging_interval_heavy: 100_000
  # eval_interval: 1000
  init_type: truncated_normal
  init_scale: 0.1
  n_blocks: 1
  final_lr_step: 1_500_000
  lr_warmup_steps: 60_000 # 1-5%
  loss_checkpoint_chungs: 4
  save_weights_path: "weights"


  # use_hidden_weights_fanin: true
  # output_weight_relative_init_scale: 0.1
  # output_weight_multiplier: 1.0

  # loss_checkpoint_chungs: 2

  # mamba_mode: 'recursive'
  # mamba_n_levels: 2
  # block_modules: ["mamba"]

  # LOCAL:
  dataset_type: c4
  batch_size: 256
  # train_dataset_path: "train_dataset_path"
  # validation_dataset_path: "aaa/ggg"

  use_dummy_dataset: true
  num_workers: 0
  save_weights_interval: 250_000
